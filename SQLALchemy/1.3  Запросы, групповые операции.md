

#### –í—ã–±–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç–æ–ª–±—Ü–∞
```sql
SELECT DISTINCT author FROM book;
```

```python
from sqlalchemy import select, func, distinct

with engine.connect() as conn:
        print("=== 1. –í–´–ë–û–†–ö–ê –£–ù–ò–ö–ê–õ–¨–ù–´–• –≠–õ–ï–ú–ï–ù–¢–û–í ===\n")
        
        # –°–ø–æ—Å–æ–± 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ distinct() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤
        print("üîç –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã (–º–µ—Ç–æ–¥ distinct):")
        stmt = select(distinct(book.c.author))
        result = conn.execute(stmt)
        for row in result:
            print(f"   üìö {row[0]}")
        
        print("\n" + "-"*50 + "\n")
        
        # –°–ø–æ—Å–æ–± 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ func.distinct() –≤ —Å–æ—Å—Ç–∞–≤–µ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        print("üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤:")
        stmt = select(func.count(distinct(book.c.author)))
        result = conn.execute(stmt)
        count = result.scalar()  # scalar() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ
        print(f"   –í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤: {count}")
        
        print("\n" + "-"*50 + "\n")
        
        # –°–ø–æ—Å–æ–± 3: –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–Ω (–∏—Å–∫–ª—é—á–∞—è NULL)
        print("üí∞ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –∫–Ω–∏–≥:")
        stmt = select(distinct(book.c.price)).where(book.c.price.is_not(None))
        result = conn.execute(stmt)
        for row in result:
            print(f"   üíµ {row[0]} —Ä—É–±.")
```

#### –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ SUM¬†–∏ COUNT

```sql
SELECT author, sum(amount), count(amount) FROM book GROUP BY author;
```
![[Pasted image 20250626164101.png]]
![[Pasted image 20250626164116.png]]

```python
with engine.connect() as conn:
	print("=== 2. –ì–†–£–ü–ü–û–í–´–ï –§–£–ù–ö–¶–ò–ò SUM –ò COUNT ===\n")
	
	# COUNT - –ø–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
	print("üìä –ü–æ–¥—Å—á–µ—Ç –∑–∞–ø–∏—Å–µ–π:")
	
	# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥
	stmt = select(func.count(book.c.book_id))
	total_books = conn.execute(stmt).scalar()
	print(f"   üìñ –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –æ –∫–Ω–∏–≥–∞—Ö: {total_books}")
	
	# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ü–µ–Ω–æ–π (–∏—Å–∫–ª—é—á–∞–µ–º NULL)
	stmt = select(func.count(book.c.price)).where(book.c.price.is_not(None))
	books_with_price = conn.execute(stmt).scalar()
	print(f"   üí∞ –ö–Ω–∏–≥ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ü–µ–Ω–æ–π: {books_with_price}")
	
	print("\n" + "-"*30 + "\n")
	
	# SUM - —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
	print("üí∞ –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π:")
	
	# –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –∫–Ω–∏–≥ (price * amount)
	stmt = select(func.sum(book.c.price * book.c.amount)).where(book.c.price.is_not(None))
	total_value = conn.execute(stmt).scalar()
	print(f"   üíé –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –∫–Ω–∏–≥: {total_value:.2f} —Ä—É–±.")
	
	# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–Ω–∏–≥
	stmt = select(func.sum(book.c.amount))
	total_amount = conn.execute(stmt).scalar()
	print(f"   üìö –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤: {total_amount}")
	
	print("\n" + "-"*30 + "\n")
	
	# –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–≤—Ç–æ—Ä–∞–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SUM –∏ COUNT
	print("üë§ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∞–≤—Ç–æ—Ä–∞–º:")
	stmt = select(
		book.c.author,                           # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∞–≤—Ç–æ—Ä—É
		func.count(book.c.book_id).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥'),        # –°—á–∏—Ç–∞–µ–º –∫–Ω–∏–≥–∏
		func.sum(book.c.amount).label('–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤')  # –°—É–º–º–∏—Ä—É–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã
	).group_by(book.c.author)  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≥—Ä—É–ø–ø–∏—Ä—É–µ–º!
	
	result = conn.execute(stmt)
	for row in result:
		print(f"   üìù {row.author}: {row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥} –∫–Ω–∏–≥(–∏), {row.–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤} —ç–∫–∑.")
```
---
#### –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ MIN, MAX –∏ AVG

```sql
SELECT author, MIN(price) as –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è_—Ü–µ–Ω–∞, MAX(price) AS –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è_—Ü–µ–Ω–∞, AVG(price) AS –°—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞
FROM book
GROUP BY author
```

```python
with engine.connect() as conn:
        print("=== 3. –ì–†–£–ü–ü–û–í–´–ï –§–£–ù–ö–¶–ò–ò MIN, MAX –ò AVG ===\n")
        
        # –û–±—â–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ü–µ–Ω–∞–º
        print("üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–µ–Ω–∞–º:")
        stmt = select(
            func.min(book.c.price).label('–º–∏–Ω_—Ü–µ–Ω–∞'),
            func.max(book.c.price).label('–º–∞–∫—Å_—Ü–µ–Ω–∞'),
            func.avg(book.c.price).label('—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞')
        ).where(book.c.price.is_not(None))  # –ò—Å–∫–ª—é—á–∞–µ–º NULL –∑–Ω–∞—á–µ–Ω–∏—è
        
        result = conn.execute(stmt)
        row = result.fetchone()
        print(f"   üí∞ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: {row.–º–∏–Ω_—Ü–µ–Ω–∞:.2f} —Ä—É–±.")
        print(f"   üí∞ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: {row.–º–∞–∫—Å_—Ü–µ–Ω–∞:.2f} —Ä—É–±.")
        print(f"   üí∞ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: {row.—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞:.2f} —Ä—É–±.")
        
        print("\n" + "-"*40 + "\n")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
        print("üìö –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤:")
        stmt = select(
            func.min(book.c.amount).label('–º–∏–Ω_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'),
            func.max(book.c.amount).label('–º–∞–∫—Å_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'),
            func.avg(book.c.amount * 1.0).label('—Å—Ä–µ–¥–Ω–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ')  # *1.0 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è float
        )
        
        result = conn.execute(stmt)
        row = result.fetchone()
        print(f"   üìñ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {row.–º–∏–Ω_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ}")
        print(f"   üìñ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {row.–º–∞–∫—Å_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ}")
        print(f"   üìñ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {row.—Å—Ä–µ–¥–Ω–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:.1f}")
        
        print("\n" + "-"*40 + "\n")
        
        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∞–≤—Ç–æ—Ä–∞–º —Å MIN, MAX, AVG
        print("üë§ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∞–≤—Ç–æ—Ä–∞–º:")
        stmt = select(
            book.c.author,
            func.min(book.c.price).label('–º–∏–Ω_—Ü–µ–Ω–∞'),
            func.max(book.c.price).label('–º–∞–∫—Å_—Ü–µ–Ω–∞'),
            func.avg(book.c.price).label('—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞'),
            func.count(book.c.book_id).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥')
        ).where(
            book.c.price.is_not(None)  # –ò—Å–∫–ª—é—á–∞–µ–º NULL —Ü–µ–Ω—ã
        ).group_by(book.c.author)
        
        result = conn.execute(stmt)
        for row in result:
            print(f"   üìù {row.author}:")
            print(f"      üí∞ –¶–µ–Ω—ã: {row.–º–∏–Ω_—Ü–µ–Ω–∞:.2f} - {row.–º–∞–∫—Å_—Ü–µ–Ω–∞:.2f} —Ä—É–±. (—Å—Ä–µ–¥: {row.—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞:.2f})")
            print(f"      üìö –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥: {row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥}")
```
####  –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö c –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º, –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```sql
SELECT author, SUM(price * amount) AS –°—Ç–æ–∏–º–æ—Å—Ç—å FROM book GROUP BY author;
```

```python
with engine.connect() as conn:
        print("=== 4. –í–´–ß–ò–°–õ–ï–ù–ò–Ø –° –ì–†–£–ü–ü–û–í–´–ú–ò –§–£–ù–ö–¶–ò–Ø–ú–ò ===\n")
        
        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ –∞–≤—Ç–æ—Ä–∞–º
        print("üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∫–Ω–∏–≥ –ø–æ –∞–≤—Ç–æ—Ä–∞–º:")
        stmt = select(
            book.c.author,
            func.sum(book.c.price * book.c.amount).label('–æ–±—â–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å'),
            func.count(book.c.book_id).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥'),
            # –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–π –∫–Ω–∏–≥–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
            (func.sum(book.c.price * book.c.amount) / func.sum(book.c.amount)).label('—Ü–µ–Ω–∞_–∑–∞_—ç–∫–∑–µ–º–ø–ª—è—Ä')
        ).where(
            book.c.price.is_not(None)
        ).group_by(book.c.author)
        
        result = conn.execute(stmt)
        for row in result:
            print(f"   üë§ {row.author}:")
            print(f"      üíé –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: {row.–æ–±—â–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å:.2f} —Ä—É–±.")
            print(f"      üìö –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π: {row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥}")
            print(f"      üí∞ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä: {row.—Ü–µ–Ω–∞_–∑–∞_—ç–∫–∑–µ–º–ø–ª—è—Ä:.2f} —Ä—É–±.")
            print()
        
        print("-"*50 + "\n")
        
        # –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–Ω–∏–≥
        print("üìä –î–æ–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –≤ –æ–±—â–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤:")
        
        # –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
        total_stmt = select(func.sum(book.c.amount))
        total_amount = conn.execute(total_stmt).scalar()
        
        # –¢–µ–ø–µ—Ä—å –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
        stmt = select(
            book.c.author,
            func.sum(book.c.amount).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤'),
            # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç: (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∞–≤—Ç–æ—Ä–∞ / –æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ) * 100
            (func.sum(book.c.amount * 100.0) / total_amount).label('–ø—Ä–æ—Ü–µ–Ω—Ç')
        ).group_by(book.c.author)
        
        result = conn.execute(stmt)
        for row in result:
            print(f"   üìà {row.author}: {row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤} —ç–∫–∑. ({row.–ø—Ä–æ—Ü–µ–Ω—Ç:.1f}%)")
        
        print("\n" + "-"*50 + "\n")
        
        # –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω–µ
        print("üèÜ –†–µ–π—Ç–∏–Ω–≥ –∞–≤—Ç–æ—Ä–æ–≤ –ø–æ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω–µ –∫–Ω–∏–≥:")
        stmt = select(
            book.c.author,
            func.avg(book.c.price).label('—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞'),
            func.count(book.c.book_id).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥')
        ).where(
            book.c.price.is_not(None)
        ).group_by(book.c.author).order_by(func.avg(book.c.price).desc())  # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é
        
        result = conn.execute(stmt)
        rank = 1
        for row in result:
            print(f"   ü•á {rank}. {row.author}: {row.—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞:.2f} —Ä—É–±. ({row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–Ω–∏–≥} –∫–Ω–∏–≥)")
            rank += 1

```
#### –í—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–æ —Ç–∞–±–ª–∏—Ü–µ —Ü–µ–ª–∏–∫–æ–º
```sql
SELECT SUM(amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM book;


SELECT SUM(amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, SUM(price * amount) AS –°—Ç–æ–∏–º–æ—Å—Ç—å 
FROM book;
```

```python
with engine.connect() as conn:
        print("=== 5. –í–´–ß–ò–°–õ–ï–ù–ò–Ø –ü–û –¢–ê–ë–õ–ò–¶–ï –¶–ï–õ–ò–ö–û–ú ===\n")
        
        # –û–±—â–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã
        print("üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞:")
        stmt = select(
            func.count(book.c.book_id).label('–≤—Å–µ–≥–æ_–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π'),
            func.sum(book.c.amount).label('–≤—Å–µ–≥–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤'),
            func.sum(book.c.price * book.c.amount).label('–æ–±—â–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å'),
            func.avg(book.c.price).label('—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞'),
            func.count(distinct(book.c.author)).label('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∞–≤—Ç–æ—Ä–æ–≤')
        ).where(book.c.price.is_not(None))
        
        result = conn.execute(stmt)
        row = result.fetchone()
        
        print(f"   üìö –í—Å–µ–≥–æ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π –∫–Ω–∏–≥: {row.–≤—Å–µ–≥–æ_–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π}")
        print(f"   üìñ –í—Å–µ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤: {row.–≤—Å–µ–≥–æ_—ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤}")
        print(f"   üí∞ –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞: {row.–æ–±—â–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å:.2f} —Ä—É–±.")
        print(f"   üíµ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∫–Ω–∏–≥–∏: {row.—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞:.2f} —Ä—É–±.")
        print(f"   üë• –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä–æ–≤: {row.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∞–≤—Ç–æ—Ä–æ–≤}")
        
        print("\n" + "-"*40 + "\n")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–µ–Ω–æ–≤—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º
        print("üí∞ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–Ω–∏–≥ –ø–æ —Ü–µ–Ω–æ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:")
        
        # –î–µ—à–µ–≤—ã–µ –∫–Ω–∏–≥–∏ (–¥–æ 500 —Ä—É–±)
        stmt = select(func.count(book.c.book_id)).where(book.c.price < 500)
        cheap_books = conn.execute(stmt).scalar()
        
        # –°—Ä–µ–¥–Ω–∏–µ –ø–æ —Ü–µ–Ω–µ (500-700 —Ä—É–±)
        stmt = select(func.count(book.c.book_id)).where(
            (book.c.price >= 500) & (book.c.price < 700)
        )
        medium_books = conn.execute(stmt).scalar()
        
        # –î–æ—Ä–æ–≥–∏–µ –∫–Ω–∏–≥–∏ (–æ—Ç 700 —Ä—É–±)
        stmt = select(func.count(book.c.book_id)).where(book.c.price >= 700)
        expensive_books = conn.execute(stmt).scalar()
        
        total_with_price = cheap_books + medium_books + expensive_books
        
        print(f"   üíö –î–µ—à–µ–≤—ã–µ (< 500 —Ä—É–±.): {cheap_books} ({cheap_books/total_with_price*100:.1f}%)")
        print(f"   üíõ –°—Ä–µ–¥–Ω–∏–µ (500-700 —Ä—É–±.): {medium_books} ({medium_books/total_with_price*100:.1f}%)")
        print(f"   üí∞ –î–æ—Ä–æ–≥–∏–µ (‚â• 700 —Ä—É–±.): {expensive_books} ({expensive_books/total_with_price*100:.1f}%)")
        
        print("\n" + "-"*40 + "\n")
        
        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Ü–µ–Ω –æ—Ç —Å—Ä–µ–¥–Ω–µ–π
        print("üìà –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã:")
        
        # –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É
        avg_price_stmt = select(func.avg(book.c.price)).where(book.c.price.is_not(None))
        avg_price = conn.execute(avg_price_stmt).scalar()
        
        print(f"   üìä –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: {avg_price:.2f} —Ä—É–±.")
        
        # –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏
        stmt = select(
            book.c.title,
            book.c.price,
            (book.c.price - avg_price).label('–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ'),
            (((book.c.price - avg_price) / avg_price) * 100).label('–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ_–ø—Ä–æ—Ü–µ–Ω—Ç')
        ).where(book.c.price.is_not(None)).order_by(book.c.price)
        
        result = conn.execute(stmt)
        for row in result:
            deviation_sign = "üìà" if row.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ > 0 else "üìâ" if row.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ < 0 else "üìä"
            print(f"   {deviation_sign} {row.title}: {row.price:.2f} —Ä—É–±. "
                  f"({row.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ:+.2f} —Ä—É–±., {row.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ_–ø—Ä–æ—Ü–µ–Ω—Ç:+.1f}%)")
```
