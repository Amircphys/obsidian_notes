


## Вставка записи в таблицу

## Create table

```sql
CREATE TABLE book(
    book_id serial not null primary key,
    title	VARCHAR(50),
    author	VARCHAR(30),
    price	DECIMAL(8, 2),
    amount	INT
    );
```


```python
import sqlalchemy
from sqlalchemy import create_engine
from sqlalchemy import MetaData


DIALECT_TYPE = "postgresql"
DBAPI = "psycopg2"
USER_NAME = "user"
PASSWORD = "password"
HOST = "localhost"
PORT = "5432"
DB = 'db' 
URL = f"{DIALECT_TYPE}+{DBAPI}://{USER_NAME}:{PASSWORD}@{HOST}:{PORT}/{DB}"
engine = create_engine(URL, echo=False)
# Проверка подключения
try:
	with engine.connect() as conn:
		print("✅ Подключение к PostgreSQL успешно!")
except OperationalError as e:
	print("❌ Ошибка подключения:", e)
exit(1)


metadata = MetaData()
from sqlalchemy import Table, Column, Integer, String, Numeric
book = Table(
	"book",
	metadata,
	Column("book_id", Integer, primary_key=True, autoincrement=True),
	Column("title", String(50), nullable=False),
	Column("author", String(30), nullable=False),
	Column("price", Numeric),
	Column("amount", Integer)
)

# Создание таблиц в БД
metadata.create_all(engine)
```

## Insert

```sql
INSERT INTO таблица(поле1, поле2) 
VALUES (значение1, значение2);



INSERT INTO book (book_id, title, author, price, amount)
VALUES (2, "Белая гвардия", "Булгаков М.А.",  540.50,  5);
INSERT INTO book (book_id, title, author, price, amount)
VALUES (3, "Идиот", "Достоевский Ф.М.",  460.00,  10);
INSERT INTO book (book_id, title, author, price, amount)
VALUES (4, "Братья Карамазовы", "Достоевский Ф.М.",  799.01,  2);
```

```python
from sqlalchemy import insert
data = [
	{"title": "Белая гвардия", "author": "Булгаков М.А.", "price": 540.50, "amount": 5},
	{"title": "Идиот", "author": "Достоевский Ф.М.", "price": 460.00, "amount": 10},
	{"title": "Братья Карамазовы", "author": "Достоевский Ф.М.", "price": 799.01, "amount": 2},
]
# Вставка данных с фиксацией транзакции
with engine.begin() as conn:
	result = conn.execute(insert(book), data)
```
