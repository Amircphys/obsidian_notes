
–ö–æ–Ω–µ—á–Ω–æ! –î–∞–≤–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º –º–µ—Ç–æ–¥ `PromptTemplate` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **LangChain**, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –±–∞–∑–æ–≤—ã—Ö –∏ –≤–∞–∂–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ (LLM). –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º—Ç–æ–≤, –¥–µ–ª–∞—è –∏—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏ —É–¥–æ–±–Ω—ã–º–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö.

---

## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ PromptTemplate?

**PromptTemplate** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –≠—Ç–æ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–µ –Ω–∞ f-—Å—Ç—Ä–æ–∫–∏ –≤ Python, —Ç–æ–ª—å–∫–æ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä—è–º–æ –≤ –∫–æ–¥, –≤—ã —Å–æ–∑–¥–∞—ë—Ç–µ —à–∞–±–ª–æ–Ω, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –µ–≥–æ –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø–µ—Ä–µ–¥–∞–≤–∞—è –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

### üì¶ –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- –ü—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å LLM —á–µ—Ä–µ–∑ LangChain.
- –î–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ç–µ–º—É —Ç–µ–∫—Å—Ç–∞, –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ç.–¥.).
- –í —Ü–µ–ø–æ—á–∫–∞—Ö (`chains`) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–æ–¥–µ–ª–∏.
- –í RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–æ–¥–µ–ª–∏ —Å —É—á–µ—Ç–æ–º retrieved –¥–∞–Ω–Ω—ã—Ö.

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã PromptTemplate

```python
from langchain.prompts import PromptTemplate
```

–ö–ª–∞—Å—Å `PromptTemplate` –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä                            | –û–ø–∏—Å–∞–Ω–∏–µ                                                                       |
| ----------------------------------- | ------------------------------------------------------------------------------ |
| `template`                          | –°—Ç—Ä–æ–∫–∞ —Å —à–∞–±–ª–æ–Ω–æ–º, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö `{variable}` |
| `input_variables`                   | –°–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —à–∞–±–ª–æ–Ω–µ                      |
| `partial_variables` *(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)* | –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —à–∞–±–ª–æ–Ω–∞                           |

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π PromptTemplate

```python
from langchain.prompts import PromptTemplate

# –°–æ–∑–¥–∞–µ–º —à–∞–±–ª–æ–Ω
template = "–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –æ {topic} –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º."

# –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç PromptTemplate
prompt = PromptTemplate(
    input_variables=["topic"],
    template=template,
)

# –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º—Ç
print(prompt.format(topic="–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏"))
```

**–í—ã–≤–æ–¥:**
```
–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –æ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º.
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 2: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

```python
template = """
–¢—ã - {profession}, —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å {concept} —á–µ–ª–æ–≤–µ–∫—É –±–µ–∑ –æ–ø—ã—Ç–∞ –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏.
–û–±—ä—è—Å–Ω–∏ –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ.
"""

prompt = PromptTemplate(
    input_variables=["profession", "concept"],
    template=template,
)

print(prompt.format(profession="—É—á–∏—Ç–µ–ª—å –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏", concept="–ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–∏"))
```

**–í—ã–≤–æ–¥:**
```
–¢—ã - —É—á–∏—Ç–µ–ª—å –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏, —Ç–µ–±–µ –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ–ª–æ–≤–µ–∫—É –±–µ–∑ –æ–ø—ã—Ç–∞ –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏.
–û–±—ä—è—Å–Ω–∏ –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ.
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 3: Partial Variables (—á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ)

–ò–Ω–æ–≥–¥–∞ —á–∞—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–≤–µ—Å—Ç–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ, –∏ –µ—ë –º–æ–∂–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å:

```python
prompt = PromptTemplate.from_template(
    "–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–∏–π {type_text} –æ {subject}."
)

# –§–∏–∫—Å–∏—Ä—É–µ–º —Ç–∏–ø —Ç–µ–∫—Å—Ç–∞ –∫–∞–∫ "—ç—Å—Å–µ"
partial_prompt = prompt.partial(type_text="—ç—Å—Å–µ")

# –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å partial_prompt, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Ç–æ–ª—å–∫–æ subject
print(partial_prompt.format(subject="–≤–ª–∏—è–Ω–∏–µ –ò–ò –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"))
```

**–í—ã–≤–æ–¥:**
```
–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ–µ —ç—Å—Å–µ –æ –≤–ª–∏—è–Ω–∏–∏ –ò–ò –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ.
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–µ —Å –º–æ–¥–µ–ª—å—é LLM

```python
from langchain.llms import OpenAI
from langchain.prompts import PromptTemplate

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ openai –∏ –∑–∞–¥–∞–π—Ç–µ API –∫–ª—é—á)
llm = OpenAI(model_name="text-davinci-003", temperature=0.7)

# –®–∞–±–ª–æ–Ω
prompt = PromptTemplate(
    input_variables=["topic"],
    template="–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ {topic}.",
)

# –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º—Ç
formatted_prompt = prompt.format(topic="–∫–æ—Å–º–æ—Å")

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–æ–¥–µ–ª—å
response = llm(formatted_prompt)
print(response)
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –æ—Ç –º–æ–¥–µ–ª–∏:**
```
–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç –æ –∫–æ—Å–º–æ—Å–µ: –ë–æ–ª–µ–µ 95% –≤–µ—â–µ—Å—Ç–≤–∞ –≤–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—ë–º–Ω–æ–π –º–∞—Ç–µ—Ä–∏–∏ –∏ —Ç—ë–º–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–∫–∞ –Ω–µ –º–æ–∂–µ–º –Ω–∞–±–ª—é–¥–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é.
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 5: JSON –∏ —Å–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å/–∑–∞–≥—Ä—É–∂–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏–ª–∏ –æ–±–º–µ–Ω–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã.

```python
prompt.save("my_prompt.json")  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
loaded_prompt = PromptTemplate.load("my_prompt.json")  # –ó–∞–≥—Ä—É–∑–∫–∞
```

---

## üß† –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PromptTemplate?

- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–º—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –ø—Ä–∞–≤–∏–ª.
- –ö–æ–≥–¥–∞ –≤—ã —Å—Ç—Ä–æ–∏—Ç–µ —Ü–µ–ø–æ—á–∫–∏ (`LLMChain`, `SequentialChain` –∏ —Ç.–¥.).
- –ß—Ç–æ–±—ã –æ—Ç–¥–µ–ª–∏—Ç—å –ª–æ–≥–∏–∫—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º—Ç–∞ –æ—Ç –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è (—á–∏—Å—Ç—ã–π –∫–æ–¥).
- –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–º—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- `FewShotPromptTemplate` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∏–º–µ—Ä—ã (few-shot learning).
- `ChatPromptTemplate` ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —á–∞—Ç-–º–æ–¥–µ–ª—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPT-3.5-turbo), —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–æ–ª–∏ (system/user/assistant).
- `PipelinePromptTemplate` ‚Äî –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤.

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`PromptTemplate` ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–º—Ç–æ–≤ –≤ LangChain. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å LLM, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞. –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–≤—ã—Ö –≤–µ—â–µ–π, –∫–æ—Ç–æ—Ä—É—é —Å—Ç–æ–∏—Ç –æ—Å–≤–æ–∏—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å LangChain.

---
–ö–æ–Ω–µ—á–Ω–æ! `ChatPromptTemplate` ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ **LangChain**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å **—á–∞—Ç-–º–æ–¥–µ–ª—è–º–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gpt-3.5-turbo`, `gpt-4` –∏ –¥—Ä—É–≥–∏–º–∏), –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ä–æ–ª—è–º–∏ (`system`, `user`, `assistant`). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ `PromptTemplate`, –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, –∞ –Ω–µ –ø—Ä–æ—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É.

---

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ ChatPromptTemplate?

`ChatPromptTemplate` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å **—à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π**, –≥–¥–µ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–º–µ–µ—Ç:
- **–†–æ–ª—å**: `system`, `user`, `assistant`.
- **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ**: —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (—á–µ—Ä–µ–∑ `{variable}`).

### üìå –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤**.
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —á–∞—Ç-–º–æ–¥–µ–ª—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ `ChatOpenAI`.
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ChatPromptTemplate

```python
from langchain.chat_models import ChatOpenAI
from langchain.prompts import ChatPromptTemplate
```

–ö–ª–∞—Å—Å `ChatPromptTemplate` —Å—Ç—Ä–æ–∏—Ç—Å—è –∏–∑ **Message Objects**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```python
messages = [
    SystemMessage(content="–¢—ã ‚Äî –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º."),
    HumanMessage(content="–ü–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É–π –º–Ω–µ 3 –≥–æ—Ä–æ–¥–∞ –≤ –ò—Ç–∞–ª–∏–∏ –¥–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è."),
    AIMessage(content="–í–æ—Ç –º–æ–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: –†–∏–º, –§–ª–æ—Ä–µ–Ω—Ü–∏—è, –í–µ–Ω–µ—Ü–∏—è.")
]
```

–ù–æ –≤–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–∞–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —à–∞–±–ª–æ–Ω—ã:

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —à–∞–±–ª–æ–Ω —Å —Ä–æ–ª—å—é `system` –∏ `user`

```python
from langchain.prompts import ChatPromptTemplate

# –°–æ–∑–¥–∞–µ–º —à–∞–±–ª–æ–Ω
template = ChatPromptTemplate.from_messages([
    ("system", "–¢—ã ‚Äî {profession}, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–º—ã –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º."),
    ("human", "–û–±—ä—è—Å–Ω–∏, —á—Ç–æ —Ç–∞–∫–æ–µ {topic}?")
])

# –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
messages = template.format_messages(profession="—É—á–∏—Ç–µ–ª—å —Ñ–∏–∑–∏–∫–∏", topic="–∫–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞")

# –¢–µ–ø–µ—Ä—å messages —Å–æ–¥–µ—Ä–∂–∏—Ç:
# [SystemMessage(content='–¢—ã ‚Äî —É—á–∏—Ç–µ–ª—å —Ñ–∏–∑–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–º—ã –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º.'),
#  HumanMessage(content='–û–±—ä—è—Å–Ω–∏, —á—Ç–æ —Ç–∞–∫–æ–µ –∫–≤–∞–Ω—Ç–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞?')]
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 2: –®–∞–±–ª–æ–Ω —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

```python
template = ChatPromptTemplate.from_messages([
    ("system", "–¢—ã ‚Äî {role}, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Å {task}."),
    ("human", "–ú–Ω–µ –Ω—É–∂–Ω–æ {request}."),
    ("ai", "–•–æ—Ä–æ—à–æ, —è –º–æ–≥—É –ø–æ–º–æ—á—å —Å —ç—Ç–∏–º.")
])

messages = template.format_messages(
    role="–ø—É—Ç–µ–≤–æ–¥–∏—Ç–µ–ª—å",
    task="—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏",
    request="–≤—ã–±—Ä–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç –ø–æ –ï–≤—Ä–æ–ø–µ –Ω–∞ 7 –¥–Ω–µ–π"
)
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 3: –†–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª—å—é (ChatOpenAI)

```python
from langchain.chat_models import ChatOpenAI

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å
llm = ChatOpenAI(model_name="gpt-3.5-turbo", temperature=0.7)

# –®–∞–±–ª–æ–Ω
template = ChatPromptTemplate.from_messages([
    ("system", "–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏. –û–±—ä—è—Å–Ω–∏, –∫–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å {dish} —à–∞–≥ –∑–∞ —à–∞–≥–æ–º."),
    ("human", "–ö–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å {dish}?")
])

# –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
messages = template.format_messages(dish="–ø–∞—ç–ª—å—é")

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–æ–¥–µ–ª—å
response = llm(messages)
print(response.content)
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–∏:**
```
–ü–∞—ç–ª—å—è ‚Äî —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ –∏—Å–ø–∞–Ω—Å–∫–æ–µ –±–ª—é–¥–æ. –í–æ—Ç –∫–∞–∫ –µ—ë –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å:
1. –ù–∞–≥—Ä–µ–π—Ç–µ –æ–ª–∏–≤–∫–æ–≤–æ–µ –º–∞—Å–ª–æ –≤ –±–æ–ª—å—à–æ–π —Å–∫–æ–≤–æ—Ä–æ–¥–µ.
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–∞—Ä–µ–∑–∞–Ω–Ω—ã–π –ª—É–∫ –∏ —á–µ—Å–Ω–æ–∫, –æ–±–∂–∞—Ä—å—Ç–µ –¥–æ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ–≥–æ —Ü–≤–µ—Ç–∞...
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 4: Partial Variables (—á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ)

–ò–Ω–æ–≥–¥–∞ —á–∞—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ:

```python
template = ChatPromptTemplate.from_messages([
    ("system", "–¢—ã ‚Äî {role}, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Å {task}."),
    ("human", "–ú–Ω–µ –Ω—É–∂–Ω–æ {request}.")
])

# –§–∏–∫—Å–∏—Ä—É–µ–º role –∏ task
partial_template = template.partial(role="–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫", task="–ø–µ—Ä–µ–≤–æ–¥–æ–º —Ç–µ–∫—Å—Ç–∞")

# –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç—å request
messages = partial_template.format_messages(request="–ø–µ—Ä–µ–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π")
```

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä 5: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞

–ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —à–∞–±–ª–æ–Ω—ã –≤ JSON –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```python
template.save("chat_prompt.json")  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
loaded_template = ChatPromptTemplate.load("chat_prompt.json")  # –ó–∞–≥—Ä—É–∑–∫–∞
```

---

## üß© –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **FewShotPromptTemplate + ChatPromptTemplate**
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø—Ä–∏–º–µ—Ä—ã (few-shot) –≤ —á–∞—Ç-—à–∞–±–ª–æ–Ω—ã:

```python
from langchain.prompts.few_shot import FewShotChatMessagePromptTemplate

examples = [
    {"input": "–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 2+2?", "output": "2+2=4"},
    {"input": "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ—Å–º–æ—Å?", "output": "–ö–æ—Å–º–æ—Å ‚Äî –≤—Å—ë —Å—É—â–µ–µ: –∑–≤—ë–∑–¥—ã, –ø–ª–∞–Ω–µ—Ç—ã, –≥–∞–ª–∞–∫—Ç–∏–∫–∏..."}
]

example_prompt = ChatPromptTemplate.from_messages([
    ("human", "{input}"),
    ("ai", "{output}")
])

few_shot_prompt = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples
)

final_prompt = ChatPromptTemplate.from_messages([
    ("system", "–¢—ã ‚Äî —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ —Ç–æ—á–Ω–æ."),
    few_shot_prompt,
    ("human", "{query}")
])

messages = final_prompt.format_messages(query="–ö–∞–∫ –∑–æ–≤—É—Ç –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –†–æ—Å—Å–∏–∏?")
```

---

## üîÑ –û—Ç–ª–∏—á–∏—è –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ PromptTemplate

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | `PromptTemplate` | `ChatPromptTemplate` |
|----------------|------------------|-----------------------|
| –¢–∏–ø –º–æ–¥–µ–ª–∏ | –°—Ç—Ä–æ–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (`text-davinci-003`) | –ß–∞—Ç-–º–æ–¥–µ–ª–∏ (`gpt-3.5-turbo`, `gpt-4`) |
| –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞ | –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ | –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ä–æ–ª—è–º–∏ |
| –†–æ–ª–∏ | –ù–µ—Ç | `system`, `user`, `assistant` |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–æ–º—Ç—ã | –î–∏–∞–ª–æ–≥–∏, –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è |

---

## üìå –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ChatPromptTemplate?

- –ö–æ–≥–¥–∞ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å **—á–∞—Ç-–º–æ–¥–µ–ª—è–º–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ChatOpenAI`).
- –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤** —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–æ–ª—è–º–∏.
- –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ **—Å–ª–æ–∂–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫** (`LLMChain`, `Agent`, `RetrievalQA` –∏ —Ç.–¥.).
- –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ **—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç** –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

---

## üöÄ –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ChatPromptTemplate](https://python.langchain.com/docs/modules/model_io/prompts/chat_prompt_template/)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ LangChain](https://github.com/langchain-ai/langchain/tree/master/libs/core/langchain_core/prompts)

---
